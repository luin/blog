---
import Layout from "layout:Post";
import { getPosts } from "../utils.astro";
import config from "../config.ts";

export async function getStaticPaths({ rss }) {
  const posts = await getPosts();

  rss({
    // The RSS Feed title, description, and custom metadata.
    title: config.name,
    // See "Styling" section below
    stylesheet: true,
    description:
      "Web developer and designer, technical book author. I build tools that help people do things better.",
    customData: `<language>zh-cn</language>`,
    // The list of items for your RSS feed, sorted.
    items: posts.map((post) => ({
      title: post.title,
      description: post.description,
      link: post.path,
      pubDate: post.publishDate,
    })),
    // Optional: Customize where the file is written to.
    // Otherwise, defaults to "/rss.xml"
    dest: "/feed.xml",
  });

  return posts.map((post) => {
    return {
      params: { slug: post.slug },
      props: { article: post },
    };
  });
}

const { article } = Astro.props;
---

<Layout content={article}><article.Content></article.Content></Layout>
